<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="end">
      <ion-button (click)="onClose()">
        <ion-icon slot="icon-only" name="close-circle"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>{{ "CHOOSE PROVIDER" | translate | uppercase }}</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content>
  <ion-segment mode="ios" value="maps" (ionChange)="segment($event)">
    <ion-segment-button value="maps">
      <ion-label>{{ "MAPS" | translate | titlecase }}</ion-label>
    </ion-segment-button>
    <ion-segment-button value="list">
      <ion-label>{{ "LIST" | translate | titlecase }}</ion-label>
    </ion-segment-button>
  </ion-segment>
  <div *ngIf="value === 'maps'; else list">
    <agm-map [latitude]="+res.latitude" [longitude]="+res.longitude" [zoom]="18">
      <agm-marker  *ngFor="let item of companies$ | async"
      [latitude]="item.distance.latitude"
      [longitude]="item.distance.longitude"
      [iconUrl]="item.type_company === 'MECHANICAL' ? './assets/images/icon-mechanics.png': './assets/images/icon-parts.png'"
      [markerDraggable]="false">
        <agm-info-window >
          <h5 class="mb-0" style="color: #000">{{ item.name }}</h5>
          <app-stars-widget [num]="getRandom()"></app-stars-widget>
          <p class="mb-0 ion-text-wrap" style="color: #000">{{ item.address }}</p>
          <ion-button (click)="clickedMarker(item)" size="small" color="danger">
            {{ "SERVICE.SEND" | translate | uppercase }}
          </ion-button>
          <ion-button (click)="onView(item, res.id)" color="primary" size="small">
            {{ "SERVICE.VIEW INFO" | translate | titlecase }}
          </ion-button>
        </agm-info-window>
      </agm-marker>
    </agm-map>
  </div>
</ion-content>
<ion-footer class="ion-no-border">
  <ion-toolbar mode="ios" color="danger">
    <ion-title mode="ios" (click)="onCancelService(res.id)">
      {{ "SERVICE.DELETE" | translate | uppercase }}
    </ion-title>
  </ion-toolbar>
</ion-footer>

<ng-template #list>
  <ion-list>
    <ion-item *ngFor="let item of companies$ | async">
      <ion-label>
        <h3>{{ item.name }}</h3>
        <app-stars-widget [num]="getRandom()"></app-stars-widget>
        <p>
          {{ "SERVICE.DISTANCE" | translate | titlecase }}
          {{ item.distance.distance }}
        </p>
        <p>
          {{ "SERVICE.TIME" | translate | titlecase }}
          {{ item.distance.duration }}
        </p>
        <p class="ion-text-wrap">{{ item.address }}</p>
        <ion-button (click)="clickedMarker(item)" color="danger" size="small" class="me-2">
          {{ "SERVICE.SEND" | translate | uppercase }}
        </ion-button>
        <ion-button (click)="onView(item, res.id)" color="primary" size="small">
          {{ "SERVICE.VIEW INFO" | translate | titlecase }}
        </ion-button>
      </ion-label>
    </ion-item>
  </ion-list>
</ng-template>
